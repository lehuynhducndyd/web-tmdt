<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="Edit variant" />
    <meta name="author" content="" />
    <title>Edit Variant - <%= device.name %>
    </title>
    <link href="/admin/css/styles.css" rel="stylesheet" />
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
</head>

<body class="sb-nav-fixed">
    <%- include('../layout/header'); -%>
        <div id="layoutSidenav">
            <%- include('../layout/sidenav'); -%>
                <div id="layoutSidenav_content">
                    <main>
                        <div class="container-fluid px-4">
                            <h1 class="mt-4">
                                <%= device.name %>
                            </h1>
                            <ol class="breadcrumb mb-4">
                                <li class="breadcrumb-item"><a href="/admin">Dashboard</a></li>
                                <li class="breadcrumb-item"><a href="/admin/view-device/<%= device._id %>">Phone</a>
                                </li>
                                <li class="breadcrumb-item active">Edit Variant</li>
                            </ol>

                            <div class="row">
                                <div class="col-6 mx-auto">
                                    <div>
                                        <h5 style="padding: 10px 0;">Edit variant for <strong>
                                                <%= device.name %>
                                            </strong></h5>
                                        <form action="/admin/update-variant/<%= variant._id %>/<%= device._id %>"
                                            method="post">

                                            <div class="mb-3">
                                                <label class="form-label">Color</label>
                                                <input type="text" class="form-control" name="color"
                                                    placeholder="Enter color" value="<%= variant.color %>" required>
                                            </div>
                                            <div class="mb-3">
                                                <label class="form-label">Discount (%)</label>
                                                <input type="number" class="form-control" name="discount" min="0"
                                                    max="100" value="<%= variant.discount %>">
                                            </div>

                                            <div class="row">
                                                <div class="col-6 mb-3">
                                                    <label class="form-label">Storage</label>
                                                    <input type="text" class="form-control" name="storage"
                                                        placeholder="e.g. 128GB" value="<%= variant.storage %>"
                                                        required>
                                                </div>

                                                <div class="col-6 mb-3">
                                                    <label class="form-label">RAM</label>
                                                    <input type="text" class="form-control" name="ram"
                                                        placeholder="e.g. 8GB" value="<%= variant.ram %>" required>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="mb-3 col-6">
                                                    <label class="form-label">Price (VNƒê)</label>
                                                    <input type="number" class="form-control" name="price"
                                                        placeholder="Enter price" value="<%= variant.price %>" required>
                                                </div>

                                                <div class="mb-3 col-6">
                                                    <label class="form-label">Stock Quantity</label>
                                                    <input type="number" class="form-control" name="stock"
                                                        placeholder="Enter stock" value="<%= variant.stock %>" required>
                                                </div>
                                            </div>

                                            <div class="mb-3">
                                                <label class="form-label">3D Model</label>
                                                <input type="text" class="form-control" name="model3d"
                                                    id="model3d-input" placeholder="https://..."
                                                    value="<%= variant.model3d || '' %>">
                                                <div id="model3d-preview" class="mt-3">
                                                    <!-- 3D model preview will be here -->
                                                </div>
                                            </div>

                                            <input type="hidden" name="deviceId" value="<%= device._id %>">

                                            <div class="mt-4">
                                                <button type="submit" class="btn btn-primary">Update Variant</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </main>
                    <%- include('../layout/footer'); -%>
                </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
            crossorigin="anonymous"></script>
        <script src="/admin/js/scripts.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                const model3dInput = document.getElementById('model3d-input');
                const model3dPreview = document.getElementById('model3d-preview');

                function updatePreview(url) {
                    model3dPreview.innerHTML = ''; // Clear previous preview
                    if (url) {
                        model3dPreview.innerHTML = `<iframe width="100%" height="400" src="${url}" frameborder="0" allowfullscreen></iframe>`;
                    }
                }

                // Initial preview on page load
                updatePreview(model3dInput.value.trim());

                // Update preview on input change
                model3dInput.addEventListener('input', (event) => updatePreview(event.target.value.trim()));
            });
        </script>
</body>

</html>